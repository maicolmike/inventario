{% extends 'base.html' %}
{% load static %}

{% block sinNada %}

<div class="container-fluid mt-4">

    {% include 'messages.html' %}

    <h4 class="text-center mb-4"><b>Listado de usuarios</b></h4>

    <div class="table-responsive">
        <table id="example1" class="table table-bordered table-hover align-middle">
            <thead class="table-secondary text-center">
                <tr>
                    <th>ID</th>
                    <th>Usuario</th>
                    <th>Nombre</th>
                    <th>Agencia</th>
                    <th>Email</th>
                    <th>Tipo usuario</th>
                    <th>Estado usuario</th>
                    <th>Editar</th>
                    <th>Clave</th>
                    <th>Borrar</th>
                </tr>
            </thead>

            <tbody>
                {% for usuarios in lista_usuarios %}
                <tr>
                    <td class="text-center">{{ usuarios.id }}</td>
                    <td>{{ usuarios.username }}</td>
                    <td>{{ usuarios.first_name }}</td>
                    <td>{{ usuarios.agencia }}</td>
                    <td>{{ usuarios.email }}</td>

                    <td class="text-center">
                        {% if usuarios.is_superuser %}
                            <span class="badge bg-primary">Administrador</span>
                        {% else %}
                            <span class="badge bg-secondary">Cliente</span>
                        {% endif %}
                    </td>

                    <td class="text-center">
                        {% if usuarios.is_active %}
                            <span class="badge bg-success">Activo</span>
                        {% else %}
                            <span class="badge bg-danger">Inactivo</span>
                        {% endif %}
                    </td>

                    <td class="text-center">
                        <button class="btn btn-info"
                                data-bs-toggle="modal"
                                data-bs-target="#modalEditar{{ usuarios.id }}">
                            <i class="fa-solid fa-pen-to-square"></i>
                        </button>
                    </td>

                    <td class="text-center">
                        <button class="btn btn-success"
                                data-bs-toggle="modal"
                                data-bs-target="#modalClave{{ usuarios.id }}">
                            <i class="fa-solid fa-key"></i>
                        </button>
                    </td>

                    <td class="text-center">
                        <button class="btn btn-danger"
                                data-bs-toggle="modal"
                                data-bs-target="#modalEliminar{{ usuarios.id }}">
                            <i class="fa-solid fa-trash-can"></i>
                        </button>
                    </td>
                </tr>

                {# ⚠️ AQUÍ SIGUE EL PROBLEMA DE RENDIMIENTO #}
                {% include 'users/modalEditar.html' %}
                {% include 'users/modalClave.html' %}
                {% include 'users/modalEliminar.html' %}

                {% endfor %}
            </tbody>
        </table>
    </div>

</div>

{% endblock %}
